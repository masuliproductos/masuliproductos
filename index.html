<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Showcase</title>
    <style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f9;
        color: #333;
        margin-top: 80px; /* Adjust body margin to prevent content from being hidden behind the fixed header */
    }

    header {
        background-color: #0078D7;
        color: white;
        padding: 1rem 2rem;
        text-align: center;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: fixed; /* Fixed position */
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000; /* Ensures the header stays on top */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Optional: Adds a slight shadow */
    }

    #cart-icon {
        cursor: pointer;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
    }

    #cart-count {
        margin-left: 8px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto; /* This centers the container */
        padding: 1rem; /* Added padding to the container */
    }

    .product-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        margin-left: auto;  /* Centering the grid horizontally */
        margin-right: auto; /* Centering the grid horizontally */
    }

    .product-card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
    }

    .product-card:hover {
        transform: scale(1.05);
    }

    .product-image img {
        width: 100%;
        height: auto;
    }

    .product-info {
        padding: 1rem;
        text-align: center;
    }

    .product-info h3 {
        margin: 0.5rem 0;
        font-size: 1.25rem;
    }

    .product-info p {
        margin: 0.5rem 0;
        color: #555;
    }

    .product-info .price {
        font-weight: bold;
        color: #0078D7;
    }

    /* Add to Cart button styles */
    .product-info .add-to-cart {
        background-color: #0078D7;
        color: white;
        font-size: 1rem;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.3s;
        width: 100%;
        text-align: center;
    }

    .product-info .add-to-cart:hover {
        background-color: #005BB5;
        transform: scale(1.05);
    }

    .product-info .add-to-cart:active {
        background-color: #004A8A;
        transform: scale(1);
    }

    /* Cart Modal Styles */
    .cart-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        padding: 20px;
    }

    .cart-modal-content {
        background: white;
        padding: 20px;
        max-width: 400px;
        margin: 0 auto;
        text-align: center;
    }

    .cart-modal-content ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .cart-modal-content li {
        margin-bottom: 10px;
    }

    /* Cart Image Style */
    .cart-image {
        width: 30px;
        margin-right: 8px;
    }

    /* Responsive grid */
    @media (max-width: 768px) {
        .product-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 480px) {
        .product-grid {
            grid-template-columns: 1fr;
        }
    }

    .whatsapp-section {
        padding-top: 30px; /* Add space above the WhatsApp section */
        padding-bottom: 20px; /* Optional: Add space below the section */
        text-align: center;
        background-color: #fff; /* Optional: Set background color for better visibility */
    }
    </style>
</head>
<body>
    <header>
        <div>
            <h1>Productos Masuli</h1>
        </div>
        <div id="cart-icon">
            <img src="https://img.icons8.com/?size=100&id=9671&format=png&color=000000" alt="Cart" class="cart-image">
            <span id="cart-count">0</span> Items - Total: $<span id="cart-total">0.00</span>
        </div>
    </header>

    <section class="container whatsapp-section">
        <p>If you have any questions, feel free to reach us on WhatsApp:</p>
        <p><strong><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/479px-WhatsApp.svg.png" alt="WhatsApp" style="width: 20px; vertical-align: middle;"> WhatsApp: <a href="https://wa.me/your_whatsapp_number" target="_blank">+1234567890</a></strong></p>
    </section>

    <main class="container">
        <div class="product-grid" id="product-grid">
            <!-- Products will be loaded here dynamically -->
        </div>
    </main>

    <!-- Cart Modal (initially hidden) -->
    <div id="cart-modal" class="cart-modal" style="display: none;">
        <div class="cart-modal-content">
            <h2>Your Cart</h2>
            <ul id="cart-items"></ul>
            <p id="total-price"></p>
            <button onclick="closeCart()">Close</button>
        </div>
    </div>
    

    <script>
        // Constant variable for the CSV URL
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR_DTbWdGZ3eB4_PbsUcI0RYlvHaDG6AsJXHybYlE38mvCYXyR5b82VqbHhHCjEh0PMOc0YheJOJTqk/pub?gid=0&single=true&output=csv';

        // Global cart array to store products added to the cart
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        // Function to load products from CSV
        async function loadProducts() {
            const response = await fetch(CSV_URL);
            const csvText = await response.text();
            const products = parseCSV(csvText);
            displayProducts(products);
        }

        // Parse the CSV into an array of objects
        function parseCSV(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim().length > 0);
            const headers = lines[0].split(',').map(header => header.replace(/^\"|\"$/g, '').trim());

            return lines.slice(1).map(line => {
                const values = line.split(',').map(value => value.replace(/^\"|\"$/g, '').trim());
                const product = {};
                headers.forEach((header, index) => {
                    product[header] = values[index] || '';
                });
                return product;
            }).filter(product => product);
        }

        // Display products in grid
        function displayProducts(products) {
            const productGrid = document.getElementById('product-grid');
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                const productImage = product.product_image ? product.product_image : 'https://via.placeholder.com/300';
                productCard.innerHTML = `
                    <div class="product-image">
                        <img src="${productImage}" alt="${product.product_name}">
                    </div>
                    <div class="product-info">
                        <h3 id="${product.product_name}">${product.product_name}</h3>
                        <p>${product.product_description}</p>
                        <p class="price">$${product.product_price}</p>
                        <button class="add-to-cart" data-product-name="${product.product_name}" data-product-price="${product.product_price}">Add to Cart</button>
                    </div>
                `;
                productGrid.appendChild(productCard);
            });

            // Add event listeners for "Add to Cart" buttons
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', addToCart);
            });
        }

        // Function to add product to the cart
        function addToCart(event) {
            const button = event.target;
            const productName = button.getAttribute('data-product-name');
            const productPrice = button.getAttribute('data-product-price');

            const product = {
                name: productName,
                price: parseFloat(productPrice),
                quantity: 1
            };

            // Check if the product is already in the cart
            const existingProduct = cart.find(item => item.name === product.name);
            if (existingProduct) {
                existingProduct.quantity += 1;
            } else {
                cart.push(product);
            }

            // Save updated cart to localStorage
            localStorage.setItem('cart', JSON.stringify(cart));

            // Update cart count and total price
            updateCart();
        }

        // Update cart count and total price in the header and modal
        function updateCart() {
            const cartCount = cart.reduce((total, product) => total + product.quantity, 0);
            const totalPrice = cart.reduce((total, product) => total + (product.price * product.quantity), 0).toFixed(2);

            // Update header
            document.getElementById('cart-count').textContent = cartCount;
            document.getElementById('cart-total').textContent = totalPrice;

            // Update modal cart total
            document.getElementById('modal-cart-total').textContent = totalPrice;
        }

        // Function to view cart items
        function viewCart() {
            const cartItemsList = document.getElementById('cart-items-list');
            cartItemsList.innerHTML = '';

            cart.forEach(product => {
                const listItem = document.createElement('li');
                listItem.textContent = `${product.name} - $${product.price} x ${product.quantity}`;
                cartItemsList.appendChild(listItem);
            });

            // Show cart modal
            document.getElementById('cart-modal').style.display = 'block';
        }

        // Function to close the cart modal
        function closeCart() {
            document.getElementById('cart-modal').style.display = 'none';
        }

        // Load products when the page loads
        window.onload = loadProducts;
    </script>
</body>
</html>
